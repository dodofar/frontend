<div class="container">

  <div class="game-container">
    <!-- Indicatore bot sta pensando -->
    <div *ngIf="isThinking" class="bot-thinking-indicator">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p>{{ 'BOT.THINKING' | translate }}</p>
    </div>

    <!-- Scacchiera (riutilizza il template della OfflineBoardComponent) -->
    <div class="board-container">
      <!-- Modale per il game over -->
      <div *ngIf="showGameOverModal" class="game-over-modal">
        <div class="modal-content">
          <div class="close-button" (click)="hideGameOverModal()">✕</div>
          <h2>{{ 'GAME_OVER.TITLE' | translate }}</h2>
          <p>
            <span *ngIf="winner === playerColor">{{ 'BOT.YOU_WON' | translate }}</span>
            <span *ngIf="winner === botColor">{{ 'BOT.BOT_WON' | translate }}</span>
          </p>
          <button class="new-game-button" (click)="resetGame()">{{ 'GAME_OVER.NEW_GAME' | translate }}</button>
        </div>
      </div>

      <div *ngIf="isAnimatingCapture" class="capture-animation-indicator">
        <p>{{ 'BOT.CAPTURING' | translate }}</p>
    </div>

      <div class="board-with-coordinates">
        <!-- Coordinate lettere (colonne) -->
        <div class="column-labels">
          <div class="corner-spacer"></div>
          <div *ngFor="let col of columns" class="col-label">{{ col }}</div>
          <div class="corner-spacer"></div>
        </div>

        <div class="board-with-row-labels">
          <!-- Coordinate numeri (righe) -->
          <div class="row-labels">
            <div *ngFor="let row of rows" class="row-label">{{ row }}</div>
          </div>

          <!-- Scacchiera -->
          <div class="board">
            <div *ngFor="let row of board; let r = index" class="row">
              <div *ngFor="let cell of row; let c = index"
                   class="square"
                   [ngClass]="{
                     'light': isLight(r, c),
                     'dark': !isLight(r, c),
                     'highlight': isHighlight(r, c),
                     'selected': isSelected(r, c)
                   }"
                   (click)="onCellClick(r, c)">
                <div *ngIf="cell.hasPiece"
                     class="piece"
                     [ngClass]="[cell.pieceColor || '', cell.isKing ? 'king' : '']">
                  <div *ngIf="cell.isKing" class="crown">♛</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="side-panel">
    <!-- Pannello opzioni bot -->
    <div class="bot-options card mb-4">
        <div class="card-header">
        <h4>{{ 'BOT.OPTIONS' | translate }}</h4>
        </div>
        <div class="card-body">
        <!-- Selezione difficoltà -->
        <div class="mb-3">
            <label class="form-label">{{ 'BOT.DIFFICULTY' | translate }}</label>
            <div class="btn-group w-100">
            <button 
                (click)="setDifficulty(1)" 
                [class.active]="difficulty === 1" 
                class="btn btn-outline-primary">
                {{ 'BOT.EASY' | translate }}
            </button>
            <button 
                (click)="setDifficulty(2)" 
                [class.active]="difficulty === 2" 
                class="btn btn-outline-primary">
                {{ 'BOT.MEDIUM' | translate }}
            </button>
            <button 
                (click)="setDifficulty(3)" 
                [class.active]="difficulty === 3" 
                class="btn btn-outline-primary">
                {{ 'BOT.HARD' | translate }}
            </button>
            </div>
        </div>
        
        <!-- Selezione colore
        <div class="mb-3">
            <label class="form-label">{{ 'BOT.YOUR_COLOR' | translate }}</label>
            <div class="btn-group w-100">
            <button 
                (click)="setColors('black')" 
                [class.active]="botColor === 'black'" 
                class="btn btn-outline-dark">
                {{ 'BOT.PLAY_WHITE' | translate }}
            </button>
            <button 
                (click)="setColors('white')" 
                [class.active]="botColor === 'white'" 
                class="btn btn-outline-light text-dark">
                {{ 'BOT.PLAY_BLACK' | translate }}
            </button>
            </div>
        </div> -->
        
        <!-- Bottone nuova partita -->
        <button (click)="resetGame()" class="btn btn-primary w-100">
            {{ 'BOT.NEW_GAME' | translate }}
        </button>
        </div>
    </div>

    <app-offline-moves [moves]="moves"></app-offline-moves>
  </div>
</div>