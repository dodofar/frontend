<div class="container">
  <div class="board-container">
    <!-- Modale per il game over -->
    <div *ngIf="showGameOverModal" class="game-over-modal">
      <div class="modal-content">
        <div class="close-button" (click)="hideGameOverModal()">✕</div>
        <h2>Partita Terminata!</h2>
        <p>Ha vinto il giocatore <span class="winner-text">{{ winner === 'white' ? 'Bianco' : 'Nero' }}</span></p>
        <button class="new-game-button" (click)="resetGame()">Nuova Partita</button>
      </div>
    </div>

    <div *ngIf="gameID" class="alert alert-info mb-3">
      Condividi questo link con il tuo avversario:<br>
      <a [href]="'/join/' + gameID">
        {{ origin + '/join/' + gameID }}
      </a>
    </div>
    
    <!-- Nome del giocatore con pedine nere (sopra) -->
    <div class="player-info black-player mb-3">
      <h3>{{ blackPlayerNickname }} (Nero)</h3>
      <div class="piece-count">Pedine: {{ blackCount }}</div>
    </div>

    <div class="board-with-coordinates">
      <!-- Coordinate lettere (colonne) in alto -->
      <div class="column-labels">
        <div class="corner-spacer"></div>
        <div *ngFor="let col of columns" class="col-label">{{ col }}</div>
        <div class="corner-spacer"></div>
      </div>

      <div class="board-with-row-labels">
        <!-- Coordinate numeri (righe) a sinistra -->
        <div class="row-labels">
          <div *ngFor="let row of rows" class="row-label">{{ row }}</div>
        </div>

        <!-- Scacchiera -->
        <div class="board">
          <div *ngFor="let row of board; let r = index" class="row">
            <div *ngFor="let cell of row; let c = index"
                 class="square"
                 [ngClass]="{
                   'light': isLight(r, c),
                   'dark': !isLight(r, c),
                   'highlight': isHighlight(r, c),
                   'selected': isSelected(r, c)
                 }"
                 (click)="onCellClick(r, c)">
              <div *ngIf="cell.hasPiece"
                   class="piece"
                   [ngClass]="[cell.pieceColor || '', cell.isKing ? 'king' : '']">
                <div *ngIf="cell.isKing" class="crown">♛</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Nome del giocatore con pedine bianche (sotto) -->
    <div class="player-info white-player mt-3">
      <h3>{{ whitePlayerNickname }} (Bianco)</h3>
      <div class="piece-count">Pedine: {{ whiteCount }}</div>
    </div>
    
    <!-- Informazioni sul turno -->
    <div class="status-info mt-3">
      <div *ngIf="playerTeam" class="current-player">
        <div *ngIf="isPlayerTurn()" class="alert alert-success">
          È il tuo turno! Muovi una pedina.
        </div>
        <div *ngIf="!isPlayerTurn()" class="alert alert-warning">
          Non è il tuo turno! Attendi la mossa di {{ currentPlayer === 'white' ? whitePlayerNickname : blackPlayerNickname }}.
        </div>
      </div>
      <div *ngIf="!playerTeam" class="alert alert-info">
        Determinazione del ruolo in corso...
      </div>
    </div>
  </div>

  <div class="side-panel">
    <app-moves [moves]="moves"></app-moves>
    <app-chat></app-chat>
  </div>
</div>